{% extends "base.html" %}
{% block content %}

  <div style="display:flex; align-items:center; justify-content:space-between;">
    <h1>{{ title }}</h1>
    <a class="btn"
       href="{{ url_for('administrator_bp.export_audit_csv', event_type=event_type) }}">
      ⬇︎ Download CSV
    </a>
  </div>
  {% if events|length == 0 %}
    <p class="muted">No events yet.</p>
  {% else %}
    <table>
      <thead>
        <tr>
          <th style="width: 18%">Time (UTC)</th>
          <th style="width: 14%">Type</th>
          <th>Details</th>
        </tr>
      </thead>
      <tbody>
        {% for e in events %}
          <tr>
            <td>{{ e.CREATED_AT.strftime('%Y-%m-%d %H:%M:%S') if e.CREATED_AT else '' }}</td>

            {# For Login Activity, show SUCCESS / FAIL / LOGOUT badge based on DETAILS #}
            {% if title == "Login Activity" %}
              {% set status = (e.DETAILS or "").split(" ", 1)[0] %}
              {% set cls = status.lower() %}
              <td><span class="badge {{ cls }}">{{ status }}</span></td>
            {% else %}
              <td>{{ e.EVENT_TYPE }}</td>
            {% endif %}

            <td><code padding:.1rem .3rem; border-radius:.25rem">{{ e.DETAILS or "" }}</code></td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% endif %}

  <p style="margin-top:1rem;">
    <a class="btn" href="{{ url_for('administrator_bp.audit_menu') }}">← Back to Audit Logs</a>
  </p>
{% endblock %}