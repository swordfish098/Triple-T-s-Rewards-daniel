{% extends "base.html" %}

{% block title %}Inactive Users - TTT Rewards{% endblock %}

{% block styles %}
  {{ super() }} {# Ensure theme.css + style.css are included #}
{% endblock %}

{% block content %}
  <div class="container">
    <div class="card">

      {# Flash messages using your alert styles #}
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          <div class="flash-messages">
            {% for category, message in messages %}
              {% if category == 'success' %}
                <div class="alert success" role="alert">{{ message }}</div>
              {% elif category == 'danger' %}
                <div class="alert error" role="alert">{{ message }}</div>
              {% elif category == 'warning' %}
                <div class="alert warning" role="alert">{{ message }}</div>
              {% else %}
                <div class="alert" role="status">{{ message }}</div>
              {% endif %}
            {% endfor %}
          </div>
        {% endif %}
      {% endwith %}

      <div style="display:flex; align-items:center; gap:.75rem; margin-bottom:1rem;">
        <a href="{{ url_for('administrator_bp.dashboard') }}" class="btn btn-outline" aria-label="Back to Administrator Dashboard">
          ‚Üê Back
        </a>
        <h1 style="margin:0;">Inactive Users</h1>
      </div>

      {% if accounts %}
        <table aria-describedby="inactive-users-caption">
          <caption id="inactive-users-caption" class="text-muted" style="text-align:left; padding:.5rem 0;">
            List of currently inactive users
          </caption>
          <thead>
            <tr>
              <th scope="col">Username</th>
              <th scope="col">Name</th>
              <th scope="col">Email</th>
              <th scope="col">Type</th>
              <th scope="col">Joined</th>
              <th scope="col" style="width: 120px;">Actions</th>
            </tr>
          </thead>
          <tbody>
          {% for user in accounts %}
            <tr>
              <td><strong>{{ user.USERNAME }}</strong></td>
              <td>{{ user.FNAME }} {{ user.LNAME }}</td>
              <td>{{ user.EMAIL }}</td>
              <td><span class="badge">{{ user.USER_TYPE }}</span></td>
              <td>{{ user.CREATED_AT.strftime('%Y-%m-%d %H:%M') }}</td>
              <td>
                {% if user.USER_CODE != current_user.USER_CODE %}
                <form
                  method="POST"
                  action="{{ url_for('administrator_bp.enable_user', user_id=user.USER_CODE) }}"
                  onsubmit="return confirm('Are you sure you want to ENABLE {{ user.USERNAME }}? This will set the account to active.');"
                  style="display:inline-block; margin:0;"
                >
                  <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                  <button
                    type="submit"
                    class="btn btn-success"
                    aria-label="Enable user {{ user.USERNAME }}"
                  >
                    Enable
                  </button>
                </form>
                {% endif %}
              </td>
            </tr>
          {% endfor %}
          </tbody>
        </table>
      {% else %}
        <div class="box" role="status">
          <p class="text-muted" style="margin:0;">No deactivated users found.</p>
        </div>
      {% endif %}
    </div>
  </div>
{% endblock %}

{% block scripts %}
  {{ super() }}
{% endblock %}
