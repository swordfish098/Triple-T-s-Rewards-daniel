<aside class="sidebar">

  <nav class="sidebar-nav">
    {% if current_user.is_authenticated %}
      <a href="{{ url_for('common.index') }}" class="sidebar-link {{ 'active' if request.endpoint == 'common.index' else '' }}">
        Home
      </a>
    {% endif %}

    {% if current_user.USER_TYPE == 'administrator' %}
      {% set admin_endpoints = ['administrator.dashboard', 'administrator.view_accounts', 'administrator.add_user', 'administrator.edit_user', 'administrator.review_sponsor_applications', 'administrator.audit_menu', 'administrator.audit_list', 'administrator.locked_users', 'administrator.disabled_accounts', 'administrator.timeout_users'] %}
      <div class="sidebar-section-header">Admin</div>
      <a href="{{ url_for('administrator_bp.dashboard') }}" class="sidebar-link {{ 'active' if request.endpoint == 'administrator_bp.dashboard' else '' }}">
        Admin Dashboard
      </a>
      <a href="{{ url_for('administrator_bp.audit_menu') }}" class="sidebar-link {{ 'active' if request.endpoint == 'administrator.audit_menu' else '' }}">
        Audit Log
      </a>
    {% endif %}

    {% if current_user.USER_TYPE == 'driver' %}
      {% set driver_endpoints = ['driver_bp.dashboard', 'driver_bp.point_history', 'driver_bp.settings', 'driver_bp.update_contact', 'driver_bp.change_password', 'driver_bp.apply_driver', 'rewards_bp.store', 'rewards_bp.view_cart'] %}
      <div class="sidebar-section-header">Driver</div>
      <a href="{{ url_for('driver_bp.dashboard') }}" class="sidebar-link {{ 'active' if request.endpoint in driver_endpoints else '' }}">
        Dashboard
      </a>
       <a href="{{ url_for('rewards_bp.store') }}" class="sidebar-link">
        Points Store
      </a>
    {% endif %}

    {% if current_user.USER_TYPE == 'sponsor' %}
      {% set sponsor_dashboard_endpoints = ['sponsor_bp.dashboard', 'sponsor_bp.update_settings'] %}
      {% set sponsor_driver_endpoints = ['sponsor_bp.manage_points_page', 'sponsor_bp.add_user', 'sponsor_bp.review_driver_applications'] %}

      <div class="sidebar-section-header">Sponsor</div>
      <a href="{{ url_for('sponsor_bp.dashboard') }}" class="sidebar-link {{ 'active' if request.endpoint in sponsor_dashboard_endpoints else '' }}">
        Dashboard
      </a>
      <a href="{{ url_for('sponsor_bp.manage_points_page') }}" class="sidebar-link {{ 'active' if request.endpoint in sponsor_driver_endpoints else '' }}">
        Driver Management
      </a>
    {% endif %}
  </nav>

  <div class="sidebar-footer">
    {% if current_user.is_authenticated %}
      <a href="{{ url_for('auth.logout') }}" class="sidebar-link logout-link">
        Logout
      </a>
    {% else %}
      <a href="{{ url_for('auth.login') }}" class="sidebar-link">
        Login
      </a>
    {% endif %}
  </div>
</aside>